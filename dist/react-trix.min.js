!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("React")):"function"==typeof define&&define.amd?define(["React"],e):"object"==typeof exports?exports["react-trix"]=e(require("React")):t["react-trix"]=e(t.React)}(this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="dist/",e(e.s=1)}([function(e,n){e.exports=t},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var React=n(0),o=function(t){function e(e){var n=t.call(this,e)||this;return n.container=null,n.editor=null,n.d=null,n.id=n.generateId(),n.state={showMergeTags:!1,tags:[]},n}return r(e,t),e.prototype.generateId=function(){var t=Date.now(),e=0;return function(){t<=e?t=++e:e=t}(),"T"+t.toString()},e.prototype.componentDidMount=function(){var t=this,e=this.props;this.container=this.d&&this.d.children&&this.d.children.length>=2?this.d.children[1]:null,this.container?(this.container.addEventListener("trix-initialize",function(){t.editor=t.container.editor,t.editor||console.error("cannot  find trix editor"),e.onEditorReady&&"function"==typeof e.onEditorReady&&e.onEditorReady(t.editor)},!1),this.container.addEventListener("trix-change",this.handleChange.bind(this),!1),e.uploadURL&&this.container.addEventListener("trix-attachment-add",this.handleUpload.bind(this))):console.error("editor not found")},e.prototype.componentWillUnmount=function(){this.container.removeEventListener("trix-initialize",this.handleChange),this.container.removeEventListener("trix-change",this.handleChange),this.props.uploadURL&&this.container.removeEventListener("trix-attachment-add",this.handleUpload)},e.prototype.handleChange=function(t){var e=this.props,n=this.state,r=t.target.innerText;e.onChange&&e.onChange(t.target.innerHTML,r);var o=this.editor.getSelectedRange();if(r&&o[0]==o[1]&&e.mergeTags){var i=o[0]-1;if(i>=0&&i<r.length)for(var a=r[i],s=0;s<e.mergeTags.length;s++)if(a==e.mergeTags[s].trigger){n.showMergeTags=!0,n.tags=e.mergeTags[s].tags,this.setState(n);break}}},e.prototype.handleUpload=function(t){var e=t.attachment;if(e.file)return this.uploadAttachment(e)},e.prototype.uploadAttachment=function(t){var e,n,r;if(e=t.file,n=new FormData,this.props.uploadData)for(var o in this.props.uploadData)n[o]=this.props.uploadData[o];return n.append("Content-Type",e.type),n.append("file",e),r=new XMLHttpRequest,r.open("POST",this.props.uploadURL,!0),r.upload.onprogress=function(e){var n=e.loaded/e.total*100;return t.setUploadProgress(n)},r.onload=function(){var e,n;if(204==r.status)return n=e=r.responseText,t.setAttributes({url:n,href:e})},r.send(n)},e.prototype.handleTagSelected=function(t,e){e.preventDefault();var n=this.state;n.showMergeTags=!1,this.setState(n),this.editor.expandSelectionInDirection("backward"),this.editor.insertString(t.tag)},e.prototype.renderTagSelector=function(t){var e=this;if(!t)return null;var n=this.editor.getClientRectAtPosition(this.editor.getSelectedRange()[0]),r={position:"absolute",top:n.top+25,left:n.left+25,width:"250px",boxSizing:"border-box",padding:0,margin:".2em 0 0",backgroundColor:"hsla(0,0%,100%,.9)",borderRadius:".3em",background:"linear-gradient(to bottom right, white, hsla(0,0%,100%,.8))",border:"1px solid rgba(0,0,0,.3)",boxShadow:".05em .2em .6em rgba(0,0,0,.2)",textShadow:"none"},o={display:"block",padding:".2em .5em",cursor:"pointer"};return React.createElement("div",{style:r},t.map(function(t){return React.createElement("a",{key:t.name,style:o,href:"#",onClick:e.handleTagSelected.bind(e,t)},t.name)}))},e.prototype.render=function(){var t=this,e=this.state,n=this.props,r={id:"editor-"+this.id,input:"input-"+this.id};n.autoFocus&&(r.autoFocus=n.autoFocus.toString()),n.placeholder&&(r.placeholder=n.placeholder);var o=null;return e.showMergeTags&&(o=this.renderTagSelector(e.tags)),React.createElement("div",{ref:function(e){return t.d=e}},React.createElement("trix-editor",r),React.createElement("input",{type:"hidden",id:"input-"+this.id,value:this.props.value}),o)},e}(React.Component);e.TrixEditor=o}])});